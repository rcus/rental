--
-- Drop all tables in the right order.
--
DROP TABLE IF EXISTS rm_BlogPost;
DROP TABLE IF EXISTS rm_BlogCategory;



--
-- Tables for blog
--
DROP TABLE IF EXISTS rm_BlogCategory;
CREATE TABLE rm_BlogCategory
(
  catId INT AUTO_INCREMENT PRIMARY KEY,
  catName VARCHAR(20) UNIQUE NOT NULL
) ENGINE INNODB CHARACTER SET utf8;

INSERT INTO rm_BlogCategory (catName) VALUES
  ('Nyheter'), ('Recensioner'), ('Erbjudande'), ('Blandat'), ('Webbtips');


DROP TABLE IF EXISTS rm_BlogPost;
CREATE TABLE rm_BlogPost
(
  postId INT AUTO_INCREMENT PRIMARY KEY,
  authorId INT NOT NULL,
  categoryId INT NOT NULL,
  title VARCHAR(100) NOT NULL,
  content TEXT,
  added TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,
  FOREIGN KEY (authorId) REFERENCES rm_Users (id),
  FOREIGN KEY (categoryId) REFERENCES rm_BlogCategory (catId)
) ENGINE INNODB CHARACTER SET utf8;

INSERT INTO rm_BlogPost (added, authorId, categoryId, title, content) VALUES 
  (DATE_SUB(NOW(), INTERVAL 10 hour), 2, 1, 'Hello World!', 'Här är det, det klassiska första inlägget!<br />Välkommen till bloggen!'),
  (DATE_SUB(NOW(), INTERVAL 9 hour), 2, 4, 'När du inte tittar på film, lär dig programmera', 'Film är ju det roligaste som finns som avkoppling, eller hur? Men det har visat sig att det finns andra sätt att ha kul med. En rekommendation är att testa på PHP-programmering. Läs mer på <a href="http://www.dbwebb.se">dbwebb</a>.'),
  (DATE_SUB(NOW(), INTERVAL 8 hour), 2, 1, '\"Turist\" kan få amerikansk remake', 'Klippt från <a href=\"https://www.moviezine.se/nyheter/turist-far-amerikansk-remake\">Moviezine</a>.<br\>Ett amerikanskt bolag vill göra en engelskspråkig version av Ruben Östlunds hyllade drama.<br />Ruben Östlunds drama \"Turist\" har blivit en rejäl snackis sedan världspremiären i Cannes och är nu på god väg att få en Oscarsnominering. Nu skriver Aftonbladet att ett amerikanskt bolag vill göra en engelskspråkig version. Parterna har de senaste dagarna haft förhandlingar för att få till ett avtal.<br />– Går det igenom kommer \"Turist\", eller \"Force Majeure\" som den heter här, att ­göras av engelskspråkiga skådespelare och en annan regissör. Samtidigt kommer handlingen att förläggas till USA, säger en källa till tidningen.<br />Producenten Erik Hemmendorf vill dock inte bekräfta något, men förnekar inte att diskussioner förs.<br />– Jag kan inte kommentera det här. Men jag har också hört ryktena, säger Hemmendorf.<br />Så sent som igår vann \"Turist\" svenska Filmkritikerförbundets filmpris Greta och på torsdag får vi veta om filmen lyckas få en Oscarsnominering eller inte.'),
  (DATE_SUB(NOW(), INTERVAL 7 hour), 1, 3, 'Snart är det Oscarsgala, det firar vi!', 'Nu är det dags att bunkra upp med popcorn, men inte bara till film. Oscarsgalan är på G, det blir alltid spännande! För att fira detta, erbjuder vi 3 filmer för 2 hela januari ut! HURRA!!'),
  (DATE_SUB(NOW(), INTERVAL 6 hour), 2, 5, 'Du har väl inte missat IMDb?', '<a href=\"http://www.imdb.com\">The Internet Movie Database</a> (IMDb) är en härlig källa till all slags information som har med filmer och TV-serier att göra. Det går även att söka på skådespelare, regissörer och folk bakom kameran.'),
  (DATE_SUB(NOW(), INTERVAL 5 hour), 2, 1, 'Vi kommer snart att flytta', 'Källaren börjar bli för trång, dags för större lokaler. Vi flyttar hela vår verksamhet till ljusa och fräscha lokaler med stora möjligheter. Välkommen att hälsa på oss när vi nu tar över Globen, Stockholm!'),
  (DATE_SUB(NOW(), INTERVAL 4 hour), 2, 2, 'Birdman (2015)', '<a href=\"http://www.gp.se/kulturnoje/recensioner/filmer/filmer3fyrar/1.2595671-birdman\">Recension från Göteborgs-Posten.</a><br>Han har aldrig varit känd som någon större lustigkurre, Iñárritu – något han visade ytterligare prov på när han medverkade i SVT-serien Bergmans Video och härom året besökte Ingmar Bergmans hem på Fårö där han ömt smekte en tall med orden \"Om filmkonsten vore en religion, skulle det här vara som Mecka eller Vatikanen\" och andäktigt slog sig ner i Bergmans fåtölj för att efter en stunds tystnad säga att \"det väcker starka känslor, mycket starka\" (samtidigt som Lars von Trier från sitt skrivbord hemma i Filmbyen påpekade att \"Bergman satt säkert och onanerade som en galning i sitt \"kloster\" på Fårö, i sitt fantastiska bibliotek och sin hemmabio, i det svenska kulturlivets maktcentrum!\"), men Birdman är något helt annat än den Iñárritu vi är vana vid, borta är både gravallvaret och greppet från hans tre första filmer med ett antal parallella öden som genom slumpen vävs samman… i ett enda kontinuum, en enda synbar tagning utan paus (om än viss fejk), utan punkt och vila, ett enda flöde med Emmanuel Luzbekis (Gravity) nerviga, rastlösa kamera likt en småfågel som från fyrtiofjärde gatan förirrat sig in på scenen, i teaterkorridorerna och logerna på Broadways St James Theatre, upp i ansiktet på skådespelaren Riggan Thomson (Keaton) som efter en nittiotalskarriär som superhjälten Birdman i tre filmer tackade nej till en fjärde till priset av att strålkastarljuset riktades om (ungefär som Keatons egen erfarenhet efter sina två Batman-filmer) nu belånat sitt hem i Malibu för att regissera och spela i en egen adaption av Raymond Carvers novell What we talk about when we talk about love och därigenom förhoppningsvis slippa att ständigt associeras med det brottsbekämpande fjäderfäet (någon genuin kärlek till teatertiljorna verkar inte finnas) samtidigt som Riggan har sitt eget ständiga självtvivel att brottas med i form av en inre Birdman-spökröst – som ömsom vårdar Riggans sköra ego, ömsom pulvriserar detsamma – samt medarbetare i form av bland andra den plötsligt inhoppande, manipulativa stjärnan Mike Shiner (Norton), en producent (ovanligt nedtonade Galifianakis) och en dotter (Stone) nyss utskriven från rehab och nu anställd som pappas assistent (som inte förlåtit honom för dennes frånvaro under uppväxten) samtidigt som premiären närmar sig och som om det inte var nog meddelar en kritikerdrake Riggan att hon redan på förhand beslutat såga föreställningen då han \"inte är skådespelare, bara kändis\" (filmens fånigaste scen, som om en aktad kritiker skulle våga yppa en sådan arbetsmetod inför den som ska nagelfaras), alltmedan kameran alltså ständigt far runt, svävar fritt, nosar sig fram, flyter omkring till tonerna av Antonio Sanchez hetsiga jazztrummor, en kamera som utser sig själv till denna existentiella svarta komedis centralgestalt vid sidan om Riggan så till den grad att de övertydligt formulerade frågorna om vad man bör vara beredd att offra för framgång och berömmelse lyckligtvis hamnar något i skymundan innan det hela utmynnar i en magisk realism som både fungerar (som greppet att – trots den obrutna tagningen – låta veckor passera) och inte gör det (leviteranden och specialeffekter à la Walter Mitty) och där man aldrig egentligen engagerar sig i huruvida det kommer att gå vägen för Riggan eller inte men där det inte råder något tvivel om att Michael Keaton aldrig mer behöver dras med Bruce Wayne-tråkningar under sin med rätta återuppväckta karriär.'),
  (DATE_SUB(NOW(), INTERVAL 3 hour), 2, 2, 'Interstellar (2014)', '<a href=\"http://www.gp.se/kulturnoje/recensioner/filmer/filmer4fyrar/1.2539942-interstellar\">Recension från Göteborgs-Posten.</a><br>Med de filmtekniskt briljanta The Dark Knight (fem fyrar i betyg från mig), Inception (fyra fyrar) och The Dark Knight rises (fem fyrar) har Christopher Nolan etablerat sig som världens kanske allra främsta filmvisionär.<br />Från filmbolagshåll hade man förstås helst sett att Nolan levererat en ny Batmanfilm, i 3D, men det blev inget med den saken. För det första ratar/hatar Nolan 3D och för det andra är detta en filmskapare som gör vad som faller honom in, även när budgeten ligger på 165 miljoner dollar. På sin sida har Nolan-fansen, några så hängivna att de i dag tar flyget från Göteborg till London, bara för att se premiärvisningen av Interstellar på en IMAX-biograf (finns inte i Sverige).<br />Interstellar, som är ett science fiction-drama, är filosofisk, meditativ, matematisk, visuellt hänförande (Hoyte Van Hoytemas fantastiska foto och knivskarpa bilder kräver en gigantisk bioduk), skickligt agerad av Matthew McConaughey, Anne Hathaway och Jessica Chastain, och på tok för lång, vi snackar tre timmar.<br />Nolan är i första hand inspirerad av Stanley Kubricks klassiker År 2001 – Ett rymdäventyr. Två andra röda trådar genom filmen är Albert Einsteins relativitetsteori och den walesiske poeten Dylan Thomas samtidigt vackra, sorgsna och livsbejakande dikt Do not go gentle into that good night.<br />Kubrick, Einstein och Thomas, alltså. Christopher Nolan befinner sig i gränslandet mellan ett gigantiskt själförtroende och en släng av storhetsvansinne.<br />Filmen inleds i ett lantligt USA. Efter en stund förstår vi att detta inte är nutid utan framtiden. Nolan ger små, små indikationer på att jordklotet drabbats av allvarliga klimatförändringar, kanske rentav någon form av katastrof? Skördarna slår fel. Syret kan vara på väg att ta slut.<br />McConaughey spelar änklingen, jordbrukaren, tvåbarnspappan och före detta piloten och astronauten Cooper. Av en slump – eller kanske ändå inte? – mer eller mindre snubblar Cooper och hans smarta unga dotter Murph (Mackenzie Foy, i vuxen ålder görs rollen av Chastain) rätt in i ett topphemligt projekt lett av den åldrade professorn Brand, spelad av Michael Caine.<br />Människan måste hitta nya boplatser. Planen är att med rymdresor utforska andra planeter, och med hjälp av så kallade maskhål förkorta restiden från några hundra år till bara ett par.<br />I rymden, där som bekant ingen kan höra dig skrika, är Interstellar mestadels stillsam, rentav vilsam, men plötsligt drar Nolan på med allt han har. Han korsklipper i ett vanvettigt högt tempo, ljudvolymen får bokstavligen biofåtöljerna att skaka. Hela filmen, som utspelas under flera decennier, bygger i stor uträckning på tempoväxlingar, på action i kontrast till livsfilosofi.<br />Frågan att fundera på hela vägen är hur regissören, som författat manuset tillsammans med sin lillebror Jonathan Nolan, skall knyta samman alla lösa trådar på slutet. Det gör man på ett smart och logiskt sätt, utan att vara övertydliga.'),
  (DATE_SUB(NOW(), INTERVAL 2 hour), 1, 5, 'Trailers på Youtube', '<a href=\"http://www.youtube.com\">YouTube</a> har många roliga filmklipp. Nyfiken på en film, se trailern... Med stor sannolikhet kan du söka upp just din film på YouTube.'),
  (DATE_SUB(NOW(), INTERVAL 1 hour), 2, 4, 'Dags för nyårslöften?', 'Förutom att titta på mer film, så finns det säkert ett och annat nyårslöfte som ska uppfyllas. Men du, oavsett hur det går, hälsa gärna på oss igen och ladda för en filmkväll.'),
  (NOW(), 2, 1, 'Agent Cooper återvänder till \"Twin Peaks\"', 'Klippt från <a href=\"https://www.moviezine.se/nyheter/agent-cooper-atervander-till-twin-peaks\">Moviezine</a>.<br\>Fram med körsbärspajen och det förbannat goda kaffet - Kyle MacLachlan kommer reprisera sin roll i \"Twin Peaks\"-comebacken.<br/>Precis som förväntat har Kyle MacLachlan sagt ja till att göra mer agent Dale Cooper när den kultförklarade serien återvänder för en tredje säsong i amerikanska kabelkanalen Showtime.<br/>MacLachlan levererade nyheten om sin återkomst under gårdagens Showtime-presskonferens, skriver Deadline. Till \"Twin Peaks\"-intromusiken gick han oannonserad ut på scenen och serverade Showtime-bossen David Nevins en kopp \"damn good coffee\", vilket var en av agent Coopers mest kända fraser.<br/>- Jag är exalterad över att få återvända till den märkliga och underbara \"Twin Peaks\"-världen, sa MacLachlan till den samlade pressen.<br/>- Må skogarna vara med er.<br/>Skaparna David Lynch och Mark Frost har planerat för en niodelad comeback som börjar spelas in nu i år. Premiären är satt till 2016 för att så på vis markera 25-årsjubileet för när sista avsnittet sändes av originalserien sändes i USA.<br/>Lynch och Frost kommer, som MovieZine tidigare rapporterat, att både skriva och producera alla avsnitt. Dessutom ska Lynch regissera vartenda ett av dem.');

DROP VIEW IF EXISTS rm_VBlogPost;
CREATE VIEW rm_VBlogPost
AS
SELECT 
  P.*, U.acronym, U.name, C.catName
FROM rm_BlogPost AS P
  LEFT OUTER JOIN rm_Users AS U
    ON P.authorId = U.id
  LEFT OUTER JOIN rm_BlogCategory AS C
    ON P.categoryId = C.catId
ORDER BY P.added DESC;
